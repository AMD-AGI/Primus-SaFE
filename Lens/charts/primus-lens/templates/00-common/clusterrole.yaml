apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: {{ include "primus-lens.fullname" . }}
  labels:
    {{- include "primus-lens.labels" . | nindent 4 }}
rules:
  # Pod 和节点相关权限
  - apiGroups: [""]
    resources: ["pods", "pods/log", "nodes", "events", "endpoints", "services", "configmaps", "secrets"]
    verbs: ["get", "list", "watch", "create", "update", "patch"]
  
  # PersistentVolumeClaims
  - apiGroups: [""]
    resources: ["persistentvolumeclaims"]
    verbs: ["get", "list", "watch"]
  
  # Deployments, DaemonSets, StatefulSets
  - apiGroups: ["apps"]
    resources: ["deployments", "daemonsets", "statefulsets", "replicasets"]
    verbs: ["get", "list", "watch"]
  
  # Jobs
  - apiGroups: ["batch"]
    resources: ["jobs", "cronjobs"]
    verbs: ["get", "list", "watch", "create", "update", "patch"]
  
  # GPU 相关 CRDs (如果存在)
  - apiGroups: ["amd.com"]
    resources: ["*"]
    verbs: ["get", "list", "watch"]
  
  # PostgreSQL Operator CRDs
  - apiGroups: ["postgres-operator.crunchydata.com"]
    resources: ["postgresclusters"]
    verbs: ["get", "list", "watch", "create", "update", "patch"]
  
  # OpenSearch Operator CRDs
  - apiGroups: ["opensearch.opster.io"]
    resources: ["opensearchclusters"]
    verbs: ["get", "list", "watch", "create", "update", "patch"]
  
  # VictoriaMetrics Operator CRDs
  - apiGroups: ["operator.victoriametrics.com"]
    resources: ["*"]
    verbs: ["get", "list", "watch", "create", "update", "patch"]
  
  # Fluent Operator CRDs
  - apiGroups: ["fluentbit.fluent.io", "fluentd.fluent.io"]
    resources: ["*"]
    verbs: ["get", "list", "watch", "create", "update", "patch"]
  
  # Grafana Operator CRDs
  - apiGroups: ["grafana.integreatly.org"]
    resources: ["*"]
    verbs: ["get", "list", "watch", "create", "update", "patch"]
  
  # 系统调优需要的节点权限
  - apiGroups: [""]
    resources: ["nodes"]
    verbs: ["get", "list", "patch"]

