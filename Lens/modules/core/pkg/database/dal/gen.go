// Code generated by gorm.io/gen. DO NOT EDIT.
// Code generated by gorm.io/gen. DO NOT EDIT.
// Code generated by gorm.io/gen. DO NOT EDIT.

package dal

import (
	"context"
	"database/sql"

	"gorm.io/gorm"

	"gorm.io/gen"

	"gorm.io/plugin/dbresolver"
)

func Use(db *gorm.DB, opts ...gen.DOOption) *Query {
	return &Query{
		db:                   db,
		AiWorkloadMetadata:   newAiWorkloadMetadata(db, opts...),
		Fault:                newFault(db, opts...),
		GpuDevice:            newGpuDevice(db, opts...),
		GpuPods:              newGpuPods(db, opts...),
		GpuPodsEvent:         newGpuPodsEvent(db, opts...),
		GpuWorkload:          newGpuWorkload(db, opts...),
		GpuWorkloadSnapshot:  newGpuWorkloadSnapshot(db, opts...),
		Node:                 newNode(db, opts...),
		NodeContainer:        newNodeContainer(db, opts...),
		NodeContainerDevices: newNodeContainerDevices(db, opts...),
		NodeContainerEvent:   newNodeContainerEvent(db, opts...),
		NodeDeviceChangelog:  newNodeDeviceChangelog(db, opts...),
		PodResource:          newPodResource(db, opts...),
		PodSnapshot:          newPodSnapshot(db, opts...),
		RdmaDevice:           newRdmaDevice(db, opts...),
		Storage:              newStorage(db, opts...),
		TrainingPerformance:  newTrainingPerformance(db, opts...),
		WorkloadEvent:        newWorkloadEvent(db, opts...),
		WorkloadPodReference: newWorkloadPodReference(db, opts...),
		WorkloadResource:     newWorkloadResource(db, opts...),
	}
}

type Query struct {
	db *gorm.DB

	AiWorkloadMetadata   aiWorkloadMetadata
	Fault                fault
	GpuDevice            gpuDevice
	GpuPods              gpuPods
	GpuPodsEvent         gpuPodsEvent
	GpuWorkload          gpuWorkload
	GpuWorkloadSnapshot  gpuWorkloadSnapshot
	Node                 node
	NodeContainer        nodeContainer
	NodeContainerDevices nodeContainerDevices
	NodeContainerEvent   nodeContainerEvent
	NodeDeviceChangelog  nodeDeviceChangelog
	PodResource          podResource
	PodSnapshot          podSnapshot
	RdmaDevice           rdmaDevice
	Storage              storage
	TrainingPerformance  trainingPerformance
	WorkloadEvent        workloadEvent
	WorkloadPodReference workloadPodReference
	WorkloadResource     workloadResource
}

func (q *Query) Available() bool { return q.db != nil }

func (q *Query) clone(db *gorm.DB) *Query {
	return &Query{
		db:                   db,
		AiWorkloadMetadata:   q.AiWorkloadMetadata.clone(db),
		Fault:                q.Fault.clone(db),
		GpuDevice:            q.GpuDevice.clone(db),
		GpuPods:              q.GpuPods.clone(db),
		GpuPodsEvent:         q.GpuPodsEvent.clone(db),
		GpuWorkload:          q.GpuWorkload.clone(db),
		GpuWorkloadSnapshot:  q.GpuWorkloadSnapshot.clone(db),
		Node:                 q.Node.clone(db),
		NodeContainer:        q.NodeContainer.clone(db),
		NodeContainerDevices: q.NodeContainerDevices.clone(db),
		NodeContainerEvent:   q.NodeContainerEvent.clone(db),
		NodeDeviceChangelog:  q.NodeDeviceChangelog.clone(db),
		PodResource:          q.PodResource.clone(db),
		PodSnapshot:          q.PodSnapshot.clone(db),
		RdmaDevice:           q.RdmaDevice.clone(db),
		Storage:              q.Storage.clone(db),
		TrainingPerformance:  q.TrainingPerformance.clone(db),
		WorkloadEvent:        q.WorkloadEvent.clone(db),
		WorkloadPodReference: q.WorkloadPodReference.clone(db),
		WorkloadResource:     q.WorkloadResource.clone(db),
	}
}

func (q *Query) ReadDB() *Query {
	return q.ReplaceDB(q.db.Clauses(dbresolver.Read))
}

func (q *Query) WriteDB() *Query {
	return q.ReplaceDB(q.db.Clauses(dbresolver.Write))
}

func (q *Query) ReplaceDB(db *gorm.DB) *Query {
	return &Query{
		db:                   db,
		AiWorkloadMetadata:   q.AiWorkloadMetadata.replaceDB(db),
		Fault:                q.Fault.replaceDB(db),
		GpuDevice:            q.GpuDevice.replaceDB(db),
		GpuPods:              q.GpuPods.replaceDB(db),
		GpuPodsEvent:         q.GpuPodsEvent.replaceDB(db),
		GpuWorkload:          q.GpuWorkload.replaceDB(db),
		GpuWorkloadSnapshot:  q.GpuWorkloadSnapshot.replaceDB(db),
		Node:                 q.Node.replaceDB(db),
		NodeContainer:        q.NodeContainer.replaceDB(db),
		NodeContainerDevices: q.NodeContainerDevices.replaceDB(db),
		NodeContainerEvent:   q.NodeContainerEvent.replaceDB(db),
		NodeDeviceChangelog:  q.NodeDeviceChangelog.replaceDB(db),
		PodResource:          q.PodResource.replaceDB(db),
		PodSnapshot:          q.PodSnapshot.replaceDB(db),
		RdmaDevice:           q.RdmaDevice.replaceDB(db),
		Storage:              q.Storage.replaceDB(db),
		TrainingPerformance:  q.TrainingPerformance.replaceDB(db),
		WorkloadEvent:        q.WorkloadEvent.replaceDB(db),
		WorkloadPodReference: q.WorkloadPodReference.replaceDB(db),
		WorkloadResource:     q.WorkloadResource.replaceDB(db),
	}
}

type queryCtx struct {
	AiWorkloadMetadata   *aiWorkloadMetadataDo
	Fault                *faultDo
	GpuDevice            *gpuDeviceDo
	GpuPods              *gpuPodsDo
	GpuPodsEvent         *gpuPodsEventDo
	GpuWorkload          *gpuWorkloadDo
	GpuWorkloadSnapshot  *gpuWorkloadSnapshotDo
	Node                 *nodeDo
	NodeContainer        *nodeContainerDo
	NodeContainerDevices *nodeContainerDevicesDo
	NodeContainerEvent   *nodeContainerEventDo
	NodeDeviceChangelog  *nodeDeviceChangelogDo
	PodResource          *podResourceDo
	PodSnapshot          *podSnapshotDo
	RdmaDevice           *rdmaDeviceDo
	Storage              *storageDo
	TrainingPerformance  *trainingPerformanceDo
	WorkloadEvent        *workloadEventDo
	WorkloadPodReference *workloadPodReferenceDo
	WorkloadResource     *workloadResourceDo
}

func (q *Query) WithContext(ctx context.Context) *queryCtx {
	return &queryCtx{
		AiWorkloadMetadata:   q.AiWorkloadMetadata.WithContext(ctx),
		Fault:                q.Fault.WithContext(ctx),
		GpuDevice:            q.GpuDevice.WithContext(ctx),
		GpuPods:              q.GpuPods.WithContext(ctx),
		GpuPodsEvent:         q.GpuPodsEvent.WithContext(ctx),
		GpuWorkload:          q.GpuWorkload.WithContext(ctx),
		GpuWorkloadSnapshot:  q.GpuWorkloadSnapshot.WithContext(ctx),
		Node:                 q.Node.WithContext(ctx),
		NodeContainer:        q.NodeContainer.WithContext(ctx),
		NodeContainerDevices: q.NodeContainerDevices.WithContext(ctx),
		NodeContainerEvent:   q.NodeContainerEvent.WithContext(ctx),
		NodeDeviceChangelog:  q.NodeDeviceChangelog.WithContext(ctx),
		PodResource:          q.PodResource.WithContext(ctx),
		PodSnapshot:          q.PodSnapshot.WithContext(ctx),
		RdmaDevice:           q.RdmaDevice.WithContext(ctx),
		Storage:              q.Storage.WithContext(ctx),
		TrainingPerformance:  q.TrainingPerformance.WithContext(ctx),
		WorkloadEvent:        q.WorkloadEvent.WithContext(ctx),
		WorkloadPodReference: q.WorkloadPodReference.WithContext(ctx),
		WorkloadResource:     q.WorkloadResource.WithContext(ctx),
	}
}

func (q *Query) Transaction(fc func(tx *Query) error, opts ...*sql.TxOptions) error {
	return q.db.Transaction(func(tx *gorm.DB) error { return fc(q.clone(tx)) }, opts...)
}

func (q *Query) Begin(opts ...*sql.TxOptions) *QueryTx {
	tx := q.db.Begin(opts...)
	return &QueryTx{Query: q.clone(tx), Error: tx.Error}
}

type QueryTx struct {
	*Query
	Error error
}

func (q *QueryTx) Commit() error {
	return q.db.Commit().Error
}

func (q *QueryTx) Rollback() error {
	return q.db.Rollback().Error
}

func (q *QueryTx) SavePoint(name string) error {
	return q.db.SavePoint(name).Error
}

func (q *QueryTx) RollbackTo(name string) error {
	return q.db.RollbackTo(name).Error
}
