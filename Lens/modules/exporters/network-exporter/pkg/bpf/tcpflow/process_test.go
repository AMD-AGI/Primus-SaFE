package tcpflow

import (
	"bytes"
	"encoding/binary"
	"testing"
)

var data = []byte{
	0x02, 0x00, 0x00, 0x16, 0x0a, 0x0e, 0x10, 0x01,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xaf, 0xbc,
	0x0a, 0x0e, 0x1f, 0x47, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x16, 0x00, 0xbc, 0xaf, 0x02, 0x00, 0x00, 0x00,
	0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0xff, 0x13, 0x07, 0xc7, 0x6f, 0x06, 0x07, 0xc7,
	0xa7, 0x01, 0x00, 0x00, 0xa7, 0x01, 0x00, 0x00,
	0x00, 0xbf, 0x07, 0x00, 0xde, 0x46, 0x01, 0x00,
	0x80, 0xfa, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x94, 0x0d, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x70, 0x72, 0x6f, 0x62, 0x65, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
}

var data1 = []byte{
	0x02, 0x00, 0x00, 0x16, 0x0a, 0x0e, 0x10, 0x01,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xaf, 0xbc,
	0x0a, 0x0e, 0x1f, 0x47, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x16, 0x00, 0xbc, 0xaf, 0x02, 0x00, 0x00, 0x00,
	0x02, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00,
	0x73, 0x18, 0x07, 0xc7, 0xe3, 0x0a, 0x07, 0xc7,
	0xa7, 0x01, 0x00, 0x00, 0xa7, 0x01, 0x00, 0x00,
	0x00, 0xbf, 0x07, 0x00, 0xdd, 0x4f, 0x01, 0x00,
	0x80, 0xfa, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x94, 0x0d, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x70, 0x72, 0x6f, 0x62, 0x65, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
}

func Test_Decode(t *testing.T) {
	p := TcpFlow{}
	err := binary.Read(bytes.NewBuffer(data), binary.LittleEndian, &p)
	if err != nil {
		t.Fatalf("parsing ringbuf record: %v", err)
	}
	t.Logf("%v", p)
}

func Test_Decode1(t *testing.T) {
	p := TcpFlow{}
	err := binary.Read(bytes.NewBuffer(data1), binary.LittleEndian, &p)
	if err != nil {
		t.Fatalf("parsing ringbuf record: %v", err)
	}
	t.Logf("%v", p)
}
