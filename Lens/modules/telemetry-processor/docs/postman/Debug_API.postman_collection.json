{
	"info": {
		"_postman_id": "debug-api-collection",
		"name": "Telemetry Processor - Debug API",
		"description": "Debug API collection for log matching and framework detection",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Test Log Matching",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"framework\": \"megatron\",\n  \"log\": \"[[32m20251202 09:12:08[0m][[36mrank-7/8[0m][[1mINFO [0m] [1m[--------trainer.py:2560] : iteration 126/ 5000 | consumed samples: 16128 | elapsed time per iteration (ms): 13372.8/13364.7 | hip mem usage/free/total/usage_ratio: 153.81GB/102.17GB/255.98GB/60.09% | throughput per GPU (TFLOP/s/GPU): 567.6/568.0 | tokens per GPU (tokens/s/GPU): 9801.4/9807.3 | learning rate: 9.984820E-06 | global batch size: 128 | lm loss: 6.548988E-03 | loss scale: 1.0 | grad norm: 0.061 | number of skipped iterations: 0 | number of nan iterations: 0 |[0m\"\n}"
				},
				"url": {
					"raw": "{{scheme}}://{{primus-lens-telemetry-processor}}/api/v1/debug/test-log-match",
					"protocol": "{{scheme}}",
					"host": [
						"{{primus-lens-telemetry-processor}}"
					],
					"path": [
						"api",
						"v1",
						"debug",
						"test-log-match"
					]
				},
				"description": "Test whether logs from specified framework can match performance patterns, and return match results, extracted groups, and converted performance data.\n\n**Request Body:**\n- `framework` (string, required): Framework name, e.g. \"megatron\", \"primus\"\n- `log` (string, required): Raw log content (may include ANSI color codes)\n\n**Response:**\n- `framework`: Framework name\n- `log_length`: Raw log length\n- `cleaned_log`: Log after ANSI codes cleaned\n- `matched`: Whether match succeeded\n- `pattern_name`: Matched pattern name\n- `groups`: All named groups extracted by regex\n- `groups_count`: Number of extracted groups\n- `performance`: Converted TrainingPerformance object\n- `error`: Error message (if any)"
			},
			"response": [
				{
					"name": "Successful Match Example",
					"originalRequest": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"framework\": \"megatron\",\n  \"log\": \"iteration 126/ 5000 | consumed samples: 16128 | ...\"\n}"
						},
						"url": {
							"raw": "{{scheme}}://{{primus-lens-telemetry-processor}}/api/v1/debug/test-log-match",
							"protocol": "{{scheme}}",
							"host": [
								"{{primus-lens-telemetry-processor}}"
							],
							"path": [
								"api",
								"v1",
								"debug",
								"test-log-match"
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n  \"code\": 200,\n  \"message\": \"success\",\n  \"data\": {\n    \"framework\": \"megatron\",\n    \"log_length\": 512,\n    \"cleaned_log\": \"[20251202 09:12:08][rank-7/8][INFO ] iteration 126/ 5000 ...\",\n    \"matched\": true,\n    \"pattern_name\": \"megatron_performance_v1\",\n    \"groups\": {\n      \"CurrentIteration\": \"126\",\n      \"TargetIteration\": \"5000\",\n      \"ConsumedSamples\": \"16128\",\n      \"MemUsage\": \"153.81\",\n      \"LearningRate\": \"9.984820E-06\",\n      \"LmLoss\": \"6.548988E-03\"\n    },\n    \"groups_count\": 17,\n    \"performance\": {\n      \"current_iteration\": 126,\n      \"target_iteration\": 5000,\n      \"consumed_samples\": 16128,\n      \"mem_usages\": 153.81,\n      \"learning_rate\": 0.000009984820,\n      \"lm_loss\": 0.006548988\n    }\n  }\n}"
				},
				{
					"name": "Match Failure Example",
					"originalRequest": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"framework\": \"megatron\",\n  \"log\": \"This is a random log line\"\n}"
						},
						"url": {
							"raw": "{{scheme}}://{{primus-lens-telemetry-processor}}/api/v1/debug/test-log-match",
							"protocol": "{{scheme}}",
							"host": [
								"{{primus-lens-telemetry-processor}}"
							],
							"path": [
								"api",
								"v1",
								"debug",
								"test-log-match"
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n  \"code\": 200,\n  \"message\": \"success\",\n  \"data\": {\n    \"framework\": \"megatron\",\n    \"log_length\": 25,\n    \"cleaned_log\": \"This is a random log line\",\n    \"matched\": false,\n    \"groups_count\": 0,\n    \"error\": \"log does not match any performance pattern\"\n  }\n}"
				}
			]
		},
		{
			"name": "List All Frameworks",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{scheme}}://{{primus-lens-telemetry-processor}}/api/v1/debug/frameworks",
					"protocol": "{{scheme}}",
					"host": [
						"{{primus-lens-telemetry-processor}}"
					],
					"path": [
						"api",
						"v1",
						"debug",
						"frameworks"
					]
				},
				"description": "List all training frameworks loaded in the system.\n\n**Response:**\n- `total`: Total number of frameworks\n- `frameworks`: List of framework names"
			},
			"response": [
				{
					"name": "Successful Response",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{scheme}}://{{primus-lens-telemetry-processor}}/api/v1/debug/frameworks",
							"protocol": "{{scheme}}",
							"host": [
								"{{primus-lens-telemetry-processor}}"
							],
							"path": [
								"api",
								"v1",
								"debug",
								"frameworks"
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n  \"code\": 200,\n  \"message\": \"success\",\n  \"data\": {\n    \"total\": 3,\n    \"frameworks\": [\n      \"megatron\",\n      \"primus\",\n      \"pytorch\"\n    ]\n  }\n}"
				}
			]
		},
		{
			"name": "View Framework Pattern Details",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{scheme}}://{{primus-lens-telemetry-processor}}/api/v1/debug/frameworks/:name/patterns?name=megatron",
					"protocol": "{{scheme}}",
					"host": [
						"{{primus-lens-telemetry-processor}}"
					],
					"path": [
						"api",
						"v1",
						"debug",
						"frameworks",
						":name",
						"patterns"
					],
					"query": [
						{
							"key": "name",
							"value": "megatron",
							"description": "Framework name (for illustration only, actual use path parameter)",
							"disabled": true
						}
					],
					"variable": [
						{
							"key": "name",
							"value": "megatron",
							"description": "Framework name, e.g.: megatron, primus, pytorch"
						}
					]
				},
				"description": "View detailed information about all log matching patterns for specified framework, including identification patterns, performance patterns, training event patterns, and checkpoint patterns.\n\n**Path Parameters:**\n- `name` (string, required): Framework name\n\n**Response:**\n- `framework`: Framework name\n- `identify_patterns`: Framework identification pattern list\n- `performance_patterns`: Performance log pattern list\n- `training_events`: Training event patterns\n- `checkpoint_events`: Checkpoint event patterns\n- `total_patterns`: Total number of patterns"
			},
			"response": [
				{
					"name": "Successful Response",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{scheme}}://{{primus-lens-telemetry-processor}}/api/v1/debug/frameworks/megatron/patterns",
							"protocol": "{{scheme}}",
							"host": [
								"{{primus-lens-telemetry-processor}}"
							],
							"path": [
								"api",
								"v1",
								"debug",
								"frameworks",
								"megatron",
								"patterns"
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n  \"code\": 200,\n  \"message\": \"success\",\n  \"data\": {\n    \"framework\": \"megatron\",\n    \"identify_patterns\": [\n      {\n        \"name\": \"megatron_trainer_import\",\n        \"pattern\": \"from megatron import.*\",\n        \"confidence\": 0.9,\n        \"tags\": [\"import\", \"module\"]\n      }\n    ],\n    \"performance_patterns\": [\n      {\n        \"name\": \"megatron_performance_v1\",\n        \"pattern\": \".*iteration\\\\s+(?P<CurrentIteration>\\\\d+)\\\\s*/\\\\s*(?P<TargetIteration>\\\\d+).*\",\n        \"confidence\": 0.95,\n        \"tags\": [\"training\", \"performance\"]\n      }\n    ],\n    \"training_events\": {\n      \"start_training\": [\n        \"training_start_pattern\"\n      ],\n      \"end_training\": [\n        \"training_end_pattern\"\n      ]\n    },\n    \"checkpoint_events\": {\n      \"start_saving\": [\n        \"checkpoint_save_start\"\n      ],\n      \"end_saving\": [\n        \"checkpoint_save_end\"\n      ],\n      \"loading\": [\n        \"checkpoint_load\"\n      ]\n    },\n    \"total_patterns\": 8\n  }\n}"
				},
				{
					"name": "Framework Not Found",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{scheme}}://{{primus-lens-telemetry-processor}}/api/v1/debug/frameworks/unknown/patterns",
							"protocol": "{{scheme}}",
							"host": [
								"{{primus-lens-telemetry-processor}}"
							],
							"path": [
								"api",
								"v1",
								"debug",
								"frameworks",
								"unknown",
								"patterns"
							]
						}
					},
					"status": "Not Found",
					"code": 404,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n  \"code\": 404,\n  \"message\": \"framework not found\",\n  \"data\": null\n}"
				}
			]
		}
	],
	"variable": [
		{
			"key": "scheme",
			"value": "http",
			"type": "string"
		},
		{
			"key": "primus-lens-telemetry-processor",
			"value": "localhost:8080",
			"type": "string"
		}
	]
}

