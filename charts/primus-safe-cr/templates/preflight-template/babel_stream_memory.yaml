apiVersion: amd.com/v1
kind: AddonTemplate
metadata:
  name: babel-stream-memory
  labels:
    primus-safe.display.name: "babel-stream-memory"
    app.kubernetes.io/managed-by: Helm
  annotations:
    meta.helm.sh/release-name: {{ .Release.Name }}
    meta.helm.sh/release-namespace: {{ .Release.Namespace }}
spec:
  type: validation
  category: System
  gpuChip: amd
  description: BabelStream is a benchmarking program designed to evaluate memory bandwidth performance.
  extensions:
    action: UkVQT19VUkw9Imh0dHBzOi8vZ2l0aHViLmNvbS9Vb0ItSFBDL0JhYmVsU3RyZWFtLmdpdCIKRElSX05BTUU9IkJhYmVsU3RyZWFtIgppZiBbICEgLWQgIiRESVJfTkFNRSIgXTsgdGhlbgogIGdpdCBjbG9uZSAiJFJFUE9fVVJMIiA+L2Rldi9udWxsIDI+ZXJyb3IKICBpZiBbICQ/IC1uZSAwIF07IHRoZW4KICAgIGNhdCBlcnJvciAmJiBybSAtZiBlcnJvcgogICAgZWNobyAiW0VSUk9SXTogZmFpbGVkIHRvIGNsb25lICRSRVBPX1VSTCIKICAgIGV4aXQgMQogIGZpCiAgcm0gLWYgZXJyb3IKZmkKY2QgIiRESVJfTkFNRSIgfHwgeyBlY2hvICJbRVJST1JdOiB1bmFibGUgdG8gYWNjZXNzICRESVJfTkFNRSI7IGV4aXQgMTsgfQoKaWYgWyAhIC1mIGJ1aWxkL2hpcC1zdHJlYW0gXTsgdGhlbgogIGNtYWtlIC1CYnVpbGQgLUguIC1ETU9ERUw9aGlwIC1EQ01BS0VfQ1hYX0NPTVBJTEVSPWhpcGNjICYmIGNtYWtlIC0tYnVpbGQgYnVpbGQgPi9kZXYvbnVsbCAyPmVycm9yCiAgaWYgWyAkPyAtbmUgMCBdOyB0aGVuCiAgICBjYXQgZXJyb3IgJiYgcm0gLWYgZXJyb3IKICAgIGVjaG8gIltFUlJPUl06IGZhaWxlZCB0byBtYWtlIgogICAgZXhpdCAxCiAgZmkKICBybSAtZiBlcnJvcgpmaQoKaWYgWyAhIC1mIHdyYXBwZXIuc2ggXTsgdGhlbgogIGVjaG8gJyMhL2Jpbi9iYXNoCiMgVXNlIHRoZSBtcGlyYW5rIHRvIG1hbmFnZSB0aGUgZGV2aWNlOgouL2J1aWxkL2hpcC1zdHJlYW0gLS1kZXZpY2UgJE9NUElfQ09NTV9XT1JMRF9SQU5LIC1uIDUwIC1zIDI2ODQzNTQ1NicgPiB3cmFwcGVyLnNoCiAgY2htb2QgdSt4IHdyYXBwZXIuc2gKZmkKCmRwa2cgLWwgfCBncmVwIC1xIG9wZW5tcGktYmluCmlmIFsgJD8gLW5lIDAgXTsgdGhlbgogIGFwdC1nZXQgLXkgaW5zdGFsbCBvcGVubXBpLWJpbiBvcGVubXBpLWNvbW1vbiBsaWJvcGVubXBpLWRldiA+L2Rldi9udWxsIDI+ZXJyb3IKICBpZiBbICQ/IC1uZSAwIF07IHRoZW4KICAgIGNhdCBlcnJvciAmJiBybSAtZiBlcnJvcgogICAgZWNobyAiW0VSUk9SXTogZmFpbGVkIHRvIGluc3RhbGwgb3Blbm1waSIKICAgIGV4aXQgMQogIGZpCiAgcm0gLWYgZXJyb3IKZmkKCkxPR19GSUxFPSIvdG1wL2JhYmVsX3N0cmVhbS5sb2ciCm1waWV4ZWMgLW4gOCAtLWFsbG93LXJ1bi1hcy1yb290IHdyYXBwZXIuc2ggPiRMT0dfRklMRSAyPiYxCkVYSVRfQ09ERT0kPwppZiBbICRFWElUX0NPREUgLW5lIDAgXTsgdGhlbgogIGNhdCAkTE9HX0ZJTEUgJiYgcm0gLWYgJExPR19GSUxFCiAgZWNobyAiW0VSUk9SXTogbXBpZXhlYyBmYWlsZWQgd2l0aCBleGl0IGNvZGU6ICRFWElUX0NPREUiCiAgZXhpdCAxCmZpCgpkZWNsYXJlIC1BIHRocmVzaG9sZHM9KAogIFsiQ29weSJdPTQxNzcyODUKICBbIk11bCJdPTQwNjcwNjkKICBbIkFkZCJdPTM5MjA4NTMKICBbIlRyaWFkIl09Mzg4NTMwMQogIFsiRG90Il09MzY2MDc4MQopCmNvcHlfc3VtPTAgbXVsX3N1bT0wIGFkZF9zdW09MCB0cmlhZF9zdW09MCBkb3Rfc3VtPTAKY29weV9jb3VudD0wIG11bF9jb3VudD0wIGFkZF9jb3VudD0wIHRyaWFkX2NvdW50PTAgZG90X2NvdW50PTAKZ3JlcCAtQTUgJ15GdW5jdGlvbicgIiRMT0dfRklMRSIgfCBhd2sgJwokMSA9PSAiQ29weSIgewogIGNvcHlfc3VtICs9ICQyOwogIGNvcHlfY291bnQgKz0gMTsKfQokMSA9PSAiTXVsIiB7CiAgbXVsX3N1bSArPSAkMjsKICBtdWxfY291bnQgKz0gMTsKfQokMSA9PSAiQWRkIiB7CiAgYWRkX3N1bSArPSAkMjsKICBhZGRfY291bnQgKz0gMTsKfQokMSA9PSAiVHJpYWQiIHsKICB0cmlhZF9zdW0gKz0gJDI7CiAgdHJpYWRfY291bnQgKz0gMTsKfQokMSA9PSAiRG90IiB7CiAgZG90X3N1bSArPSAkMjsKICBkb3RfY291bnQgKz0gMTsKfQpFTkQgewogIGlmIChjb3B5X2NvdW50ID4gMCkgICBwcmludCAiQ29weSAiICAgY29weV9zdW0gLyBjb3B5X2NvdW50OwogIGlmIChtdWxfY291bnQgPiAwKSAgICBwcmludCAiTXVsICIgICAgbXVsX3N1bSAvIG11bF9jb3VudDsKICBpZiAoYWRkX2NvdW50ID4gMCkgICAgcHJpbnQgIkFkZCAiICAgIGFkZF9zdW0gLyBhZGRfY291bnQ7CiAgaWYgKHRyaWFkX2NvdW50ID4gMCkgIHByaW50ICJUcmlhZCAiICB0cmlhZF9zdW0gLyB0cmlhZF9jb3VudDsKICBpZiAoZG90X2NvdW50ID4gMCkgICAgcHJpbnQgIkRvdCAiICAgIGRvdF9zdW0gLyBkb3RfY291bnQ7Cn0nIHwgd2hpbGUgcmVhZCAtciBmdW5jIGF2ZzsgZG8KICBmb3JtYXR0ZWRfYXZnPSQoZWNobyAiJGF2ZyIgfCBhd2sgJ3twcmludGYgIiVmIiwgJDF9JykKICB0aHJlc2hvbGQ9JHt0aHJlc2hvbGRzWyRmdW5jXX0KICBpc19ncmVhdGVyPSQoZWNobyAiJGZvcm1hdHRlZF9hdmcgPiAkdGhyZXNob2xkIiB8IGJjIC1sKQogIGlmIFtbICIkaXNfZ3JlYXRlciIgLWVxIDEgXV07IHRoZW4KICAgIGVjaG8gIltJTkZPXSAkZnVuYyBhdmVyYWdlOiAkZm9ybWF0dGVkX2F2ZyA+ICR0aHJlc2hvbGQiCiAgZWxzZQogICAgZWNobyAiW0VSUk9SXSAkZnVuYyBhdmVyYWdlOiAkZm9ybWF0dGVkX2F2ZyA8PSAkdGhyZXNob2xkIgogICAgYWxsX3Bhc3NlZD0xCiAgZmkKZG9uZQpybSAtZiAkTE9HX0ZJTEUKaWYgW1sgIiRhbGxfcGFzc2VkIiAtZXEgMSBdXTsgdGhlbgogIGVjaG8gIltFUlJPUl0gZmFpbGVkIHRvIGRvIEJhYmVsU3RyZWFtIGJlbmNobWFya2luZyIKICBleGl0IDEKZmkKZWNobyAiW1NVQ0NFU1NdIGFsbCBCYWJlbFN0cmVhbSBiZW5jaG1hcmtpbmcgcGFzc2VkIgpleGl0IDAK
